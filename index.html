<!DOCTYPE html>
<html>

<head>
  <title>Has Youtube Playlists Enhancer</title>
  <meta charset="utf-8" />
</head>

<body>
  <p>Has Youtube Playlists Enhancer</p>
  <button id="fetch-videos">Fetch Playlist Videos</button>
  <p id="videoslist"></p>

  <script>
    function getPlaylistID() {
      var match, playList_ID, playlist_url;
      playlist_url = "https://www.youtube.com/playlist?list=PLsyeobzWxl7poL9JTVyndKe62ieoN-MZ3";

      let regex = /list=([a-zA-Z0-9_-]+)/;
      match = playlist_url.match(regex);

      if (match) {
        playList_ID = match[1];
        console.log("Playlist ID:", playList_ID);
      } else {
        console.log("Could not extract playlist ID.");
      }
      return playList_ID;
    }


    // Replace 'YOUR_API_KEY' with your actual API key
    const apiKey = 'AIzaSyBirpEydenGZDoSY4ED0lXGmD0F57y6C9o';

    function fetchPlaylistVideos(playlistId, pageToken, callback) {
      var videos = [];
      let url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${playlistId}&key=${apiKey}`;
      if (pageToken) {
        url += `&pageToken=${pageToken}`;
      }
      fetch(url)
      .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok ' + response.statusText);
      }
      return response.json();
    })
        .then(data => {
          // Process the data.items array
          var videos = data.items.map(item => item.snippet.title);
          callback(videos); // Call the callback function with the titles
          data.items.forEach(item => {
            console.log(item.snippet.title); // Log the title of each video
          });

          // Check if there are more pages
          if (data.nextPageToken) {
            fetchPlaylistVideos(playlistId, data.nextPageToken, callback);
          } else {
            // If no more pages, call the callback function
            callback(videos);
          }
        })
        .catch(error => {
          console.error('Error fetching data: ', error);
          callback([]); // Call the callback with an empty array in case of error
        });
    }

    document.getElementById('fetch-videos').addEventListener('click', function () {
  var playlistId = getPlaylistID(); // Replace with your actual playlist ID
  fetchPlaylistVideos(playlistId, function(videos) {
    // Update your UI here with the videos
    document.getElementById('videosList').innerHTML = videos.map(video => video.snippet.title).join('<br>');
  });
});
  </script>
</body>

</html>